FFS;

Get["func.n"];
ring$name="HER"; ! "LER"
bdir = "./../TbT/20May19/";
ldir = "./lattice_current/";

Library@Require["LEROptics","HEROptics"];
If[ring$name=="HER",
ring=LEROptics[];
,
ring=HEROptics[];
];

fn = FileNames2[ring$name//"*", bdir];

Scan[(
  ring@ReadOpticsFile[bdir//#];
  CALC;
  CreatePlainDeck[ldir//#, "RING"])&,
  fn];

end;
abort;
